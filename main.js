!function(){"use strict";function e(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var t=class{constructor(e,t){var r,n,i;r=this,i=()=>this._inputEls.every((e=>e.validity.valid)),(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(n="_checkFormValidity"))in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const r=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),r.textContent=t,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._checkFormValidity()?this._enableSubmitBtn(this.submitButton):this.disableSubmitBtn(this.submitButton)}disableSubmitBtn(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableSubmitBtn(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputEls,this.submitButton)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n=class{constructor(e){let{popupSelector:t}=e;r(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),r(this,"_handleOverlay",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleOverlay)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleOverlay)}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close-button")&&this.close()}))}},i=class extends n{constructor(e,t){super({popupSelector:e}),this._form=this._popupElement.querySelector(".form"),this._handleFormSubmit=t,this._formInputs=this._popupElement.querySelectorAll(".form__input")}close(){this._form.reset(),super.close()}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close()}))}};document.querySelector(".cards__list");const s=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),l=(o.querySelector(".modal__close-button"),document.querySelector("#edit-profile-form"),document.querySelector(".cards__list"),document.querySelector(".profile__add-button")),a=document.querySelector("#place-add-modal"),c=(a.querySelector(".modal__close-button"),document.querySelector("#add-place-form").querySelector(".form__button"),document.querySelector("#preview-image-modal").querySelector(".modal__close-button"),document.querySelector(".modal__image"),document.querySelector(".modal__caption"),document.querySelector("#profile-title-input")),u=document.querySelector("#profile-description-input"),m=(document.querySelector("#place-title-input"),document.querySelector("#image-url-input"),document.querySelector("#card-template").content.firstElementChild,{inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"}),d=new i("#place-add-modal",(e=>{const t=f(e);h.addItem(t),d.close(),y.disableSubmitBtn()}));d.setEventListeners();const _=new class{constructor(e){let{nameSelector:t,jobSelector:r}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,description:r}=e;this._nameElement.textContent=t,this._jobElement.textContent=r}}({nameSelector:".profile__title",jobSelector:".profile__description"}),h=new class{constructor(e,t){let{items:r,renderer:n}=e;this._items=r,this._renderer=n,this._cardsList=document.querySelector(t)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._cardsList.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=f(e);h.addItem(t)}},".cards__list");h.renderItems();const p=new i("#profile-edit-modal",(e=>{_.setUserInfo(e)}));p.setEventListeners();const v=new class extends n{constructor(e){super({popupSelector:e})}open(e,t){this._image=this._popupElement.querySelector(".modal__image"),this._popupElement.querySelector(".modal__caption").textContent=e,this._image.src=t,this._image.alt=e,super.open()}}("#preview-image-modal");function f(t){return new class{constructor(t,r,n){let{name:i,link:s}=t;e(this,"_handleLikeIcon",(()=>{this._likeButton.classList.toggle("card__like-button_active")})),e(this,"_handleDeleteCard",(()=>{this._cardElement.remove()})),this._name=i,this._link=s,this._cardTemplate=r,this._handleImageClick=n}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeIcon),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard({name:this._name,link:this._link})})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}getView(){return this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._setEventListeners(),this._cardElement}}({name:t.name,link:t.link},"#card-template",(e=>{let{name:t,link:r}=e;v.open(t,r)})).getView()}v.setEventListeners(),s.addEventListener("click",(()=>{const e=_.getUserInfo();c.value=e.name,u.value=e.job,p.open()})),l.addEventListener("click",(()=>{y.disableSubmitBtn(),d.open()}));const b=new t(m,o),y=new t(m,a);b.enableValidation(),y.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZCxDQVpBbkIsRUFBZW5ELG9CQWNmWSxFQUFrQjdCLGlCQUFpQixTQUFTLEtBQzFDLE1BQU15RixFQUFXM0MsRUFBU0ssY0FDMUJsQixFQUFrQkwsTUFBUTZELEVBQVM5RCxLQUNuQ08sRUFBd0JOLE1BQVE2RCxFQUFTckMsSUFDekNjLEVBQWlCckQsTUFBTSxJQUd6QmtCLEVBQWlCL0IsaUJBQWlCLFNBQVMsS0FDekM2QyxFQUFpQnBELG1CQUNqQjZDLEVBQWF6QixNQUFNLElBR3JCLE1BQU02RSxFQUFvQixJQUFJQyxFQUM1QnhELEVBQ0FMLEdBR0llLEVBQW1CLElBQUk4QyxFQUFjeEQsRUFBb0JILEdBRS9EMEQsRUFBa0J4RixtQkFDbEIyQyxFQUFpQjNDLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsKSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsLCB2YWxpZGF0aW9uTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gdmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgaXNGb3JtVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xuICAgIGlmIChpc0Zvcm1WYWxpZCkge1xuICAgICAgdGhpcy5fZW5hYmxlU3VibWl0QnRuKHRoaXMuc3VibWl0QnV0dG9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kaXNhYmxlU3VibWl0QnRuKHRoaXMuc3VibWl0QnV0dG9uKTtcbiAgICB9XG4gIH1cblxuICBkaXNhYmxlU3VibWl0QnRuKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlU3VibWl0QnRuKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT5cbiAgICB0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVscywgdGhpcy5zdWJtaXRCdXR0b24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXkpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlT3ZlcmxheSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlT3ZlcmxheSA9IChlKSA9PiB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG5cbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuXG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgY2FyZHNXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRDbG9zZUJ1dHRvbiA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gXCIucHJvZmlsZV9fdGl0bGVcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiO1xuZXhwb3J0IGNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuLy9cbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHBsYWNlQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlLWFkZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwbGFjZUFkZENsb3NlQnV0dG9uID0gcGxhY2VBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgYWRkUGxhY2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtcGxhY2UtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhZGRQbGFjZVN1Ym1pdEJ1dHRvbiA9IGFkZFBsYWNlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcbi8vXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlQ2xvc2VCdXR0b24gPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbi8vXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5leHBvcnQgY29uc3QgcGxhY2VUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGFjZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBpbWFnZVVSTElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS11cmwtaW5wdXRcIik7XG4vL1xuXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgcHJvZmlsZUVkaXRGb3JtLFxuICBwcm9maWxlRWRpdENsb3NlQnV0dG9uLFxuICBwcm9maWxlQWRkQnV0dG9uLFxuICBwbGFjZUFkZENsb3NlQnV0dG9uLFxuICBwcmV2aWV3SW1hZ2VDbG9zZUJ1dHRvbixcbiAgYWRkUGxhY2VGb3JtLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgcHJldmlld0ltYWdlTW9kYWwsXG4gIGNhcmRzV3JhcCxcbiAgcHJvZmlsZUVkaXRNb2RhbCxcbiAgcGxhY2VBZGRNb2RhbCxcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHByb2ZpbGVUaXRsZSxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgcGxhY2VUaXRsZUlucHV0LFxuICBpbWFnZVVSTElucHV0LFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudC5qc1wiO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwbGFjZS1hZGQtbW9kYWxcIiwgKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcbiAgYWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlU3VibWl0QnRuKCk7XG59KTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogcHJvZmlsZVRpdGxlLFxuICBqb2JTZWxlY3RvcjogcHJvZmlsZURlc2NyaXB0aW9uLFxufSk7XG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgIH0sXG4gIH0sXG4gIFwiLmNhcmRzX19saXN0XCJcbik7XG5zZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiwgKHZhbHVlcykgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh2YWx1ZXMpO1xufSk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICB7IG5hbWU6IGNhcmREYXRhLm5hbWUsIGxpbms6IGNhcmREYXRhLmxpbmsgfSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKHsgbmFtZSwgbGluayB9KSA9PiB7XG4gICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xuICAgIH1cbiAgKTtcblxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXRCdG4oKTtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVFZGl0TW9kYWxcbik7XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIHBsYWNlQWRkTW9kYWwpO1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2FyZHNMaXN0KSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZHNMaXN0KTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NhcmRzTGlzdC5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gIH1cblxuICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkVGVtcGxhdGUsIGhhbmRsZUltYWdlQ2xpY2spIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBjYXJkVGVtcGxhdGU7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFRlbXBsYXRlKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VJY29uKTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VJY29uID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfTtcblxuICBfaGFuZGxlRGVsZXRlQ2FyZCA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgfTtcblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJ0aGlzIiwiX2lucHV0RWxzIiwiZXZlcnkiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZUVsIiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJfZW5hYmxlU3VibWl0QnRuIiwic3VibWl0QnV0dG9uIiwiZGlzYWJsZVN1Ym1pdEJ0biIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVPdmVybGF5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtSW5wdXRzIiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVBZGRCdXR0b24iLCJwbGFjZUFkZE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInZhbGlkYXRpb25TZXR0aW5ncyIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImFkZENhcmRQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJjYXJkRGF0YSIsImNhcmQiLCJjcmVhdGVDYXJkIiwic2VjdGlvbiIsImFkZEl0ZW0iLCJhZGRGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiZGVzY3JpcHRpb24iLCJjYXJkc0xpc3QiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NhcmRzTGlzdCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsInByZXBlbmQiLCJsaW5rIiwiZWRpdFByb2ZpbGVQb3B1cCIsInZhbHVlcyIsInBvcHVwV2l0aEltYWdlIiwiX2ltYWdlIiwic3JjIiwiYWx0IiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlSW1hZ2VDbGljayIsIl9saWtlQnV0dG9uIiwidG9nZ2xlIiwiX2NhcmRFbGVtZW50IiwiX25hbWUiLCJfbGluayIsIl9jYXJkVGVtcGxhdGUiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9nZXRUZW1wbGF0ZSIsImNsb25lTm9kZSIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkSW1hZ2UiLCJnZXRWaWV3IiwiX2NhcmRUaXRsZSIsInVzZXJEYXRhIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==